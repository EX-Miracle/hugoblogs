{{- /* Deprecate site.Author.email in favor of site.Params.author.email */}}
{{- $authorEmail := "" }}
{{- with site.Params.author }}
  {{- if reflect.IsMap . }}
    {{- with .email }}
      {{- $authorEmail = . }}
    {{- end }}
  {{- end }}
{{- else }}
  {{- with site.Author.email }}
    {{- $authorEmail = . }}
    {{- warnf "The author key in site configuration is deprecated. Use params.author.email instead." }}
  {{- end }}
{{- end }}

{{- /* Deprecate site.Author.name in favor of site.Params.author.name */}}
{{- $authorName := "" }}
{{- with site.Params.author }}
  {{- if reflect.IsMap . }}
    {{- with .name }}
      {{- $authorName = . }}
    {{- end }}
  {{- else }}
    {{- $authorName  = . }}
  {{- end }}
{{- else }}
  {{- with site.Author.name }}
    {{- $authorName = . }}
    {{- warnf "The author key in site configuration is deprecated. Use params.author.name instead." }}
  {{- end }}
{{- end }}

{{- $pctx := . }}
{{- if .IsHome }}{{ $pctx = .Site }}{{ end }}
{{- $pages := slice }}
{{- if or $.IsHome $.IsSection }}
{{- $pages = $pctx.RegularPages }}
{{- else }}
{{- $pages = $pctx.Pages }}
{{- end }}
{{- $limit := .Site.Config.Services.RSS.Limit }}
{{- if ge $limit 1 }}
{{- $pages = $pages | first $limit }}
{{- end }}
{{- printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML }}
<?xml-stylesheet type="text/xsl" href="data:text/xsl;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48eHNsOnN0eWxlc2hlZXQgdmVyc2lvbj0iMy4wIiB4bWxuczp4c2w9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvWFNML1RyYW5zZm9ybSIgeG1sbnM6YXRvbT0iaHR0cDovL3d3dy53My5vcmcvMjAwNS9BdG9tIj48eHNsOm91dHB1dCBtZXRob2Q9Imh0bWwiIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04IiBpbmRlbnQ9InllcyIvPjx4c2w6dGVtcGxhdGUgbWF0Y2g9Ii8iPjxodG1sPjxoZWFkPjxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MSIvPjxtZXRhIG5hbWU9InJlZmVycmVyIiBjb250ZW50PSJ1bnNhZmUtdXJsIi8+PHRpdGxlPjx4c2w6dmFsdWUtb2Ygc2VsZWN0PSIvYXRvbTpmZWVkL2F0b206dGl0bGUiLz48L3RpdGxlPjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly93d3cuZmVlZC5zdHlsZS9jc3Mvd2F0ZXIubWluLmNzcyIvPjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2NsaXBib2FyZEAyLjAuMTEvZGlzdC9jbGlwYm9hcmQubWluLmpzIi8+PHNjcmlwdD5uZXcgQ2xpcGJvYXJkSlMoJy5jbGlwYm9hcmQnKTs8L3NjcmlwdD48L2hlYWQ+PGJvZHk+PGgxPjx4c2w6dmFsdWUtb2Ygc2VsZWN0PSIvYXRvbTpmZWVkL2F0b206dGl0bGUiLz48L2gxPjxwPjx4c2w6dmFsdWUtb2Ygc2VsZWN0PSIvYXRvbTpmZWVkL2F0b206c3VidGl0bGUiLz48L3A+PHA+ClRoaXMgaXMgdGhlIEF0b20gbmV3cyBmZWVkIGZvciB0aGU8YT48eHNsOmF0dHJpYnV0ZSBuYW1lPSJocmVmIj48eHNsOnZhbHVlLW9mIHNlbGVjdD0iL2F0b206ZmVlZC9hdG9tOmxpbmtbQHJlbD0nYWx0ZXJuYXRlJ10vQGhyZWYgfCAvYXRvbTpmZWVkL2F0b206bGlua1tub3QoQHJlbCldL0BocmVmIi8+PC94c2w6YXR0cmlidXRlPjx4c2w6dmFsdWUtb2Ygc2VsZWN0PSIvYXRvbTpmZWVkL2F0b206dGl0bGUiLz48L2E+CndlYnNpdGUuPC9wPjxwPkl0IGlzIG1lYW50IGZvciBuZXdzIHJlYWRlcnMsIG5vdCBodW1hbnMuIFBsZWFzZSBjb3B5LWFuZC1wYXN0ZSB0aGUgVVJMIGludG8geW91ciBuZXdzIHJlYWRlciE8L3A+PHA+PHByZT48Y29kZSBpZD0iZmVlZHVybCI+PHhzbDp2YWx1ZS1vZiBzZWxlY3Q9Ii9hdG9tOmZlZWQvYXRvbTpsaW5rW0ByZWw9J3NlbGYnXS9AaHJlZiIvPjwvY29kZT48L3ByZT48YnV0dG9uIGNsYXNzPSJjbGlwYm9hcmQiIGRhdGEtY2xpcGJvYXJkLXRhcmdldD0iI2ZlZWR1cmwiPgpDb3B5IHRvIGNsaXBib2FyZDwvYnV0dG9uPjwvcD48dWw+PHhzbDpmb3ItZWFjaCBzZWxlY3Q9Ii9hdG9tOmZlZWQvYXRvbTplbnRyeSI+PGxpPjx4c2w6dmFsdWUtb2Ygc2VsZWN0PSJhdG9tOnRpdGxlIi8+Cig8eHNsOnZhbHVlLW9mIHNlbGVjdD0iYXRvbTp1cGRhdGVkIi8+KTwvbGk+PC94c2w6Zm9yLWVhY2g+PC91bD48cD48eHNsOnZhbHVlLW9mIHNlbGVjdD0iY291bnQoL2F0b206ZmVlZC9hdG9tOmVudHJ5KSIvPiBuZXdzIGl0ZW1zLjwvcD48cD48c21hbGw+UG93ZXJlZCBieTxhIGhyZWY9Imh0dHBzOi8vd3d3LmZlZWQuc3R5bGUvIj48aW1nIHJlZmVycmVycG9saWN5PSJvcmlnaW4iIHNyYz0iaHR0cHM6Ly93d3cuZmVlZC5zdHlsZS9mYXZpY29uLnN2ZyIgc3R5bGU9ImhlaWdodDoxZW07cGFkZGluZy1yaWdodDowLjI1ZW07dmVydGljYWwtYWxpZ246bWlkZGxlOyIvPkZlZWQuU3R5bGU8L2E+PC9zbWFsbD48L3A+PC9ib2R5PjwvaHRtbD48L3hzbDp0ZW1wbGF0ZT48L3hzbDpzdHlsZXNoZWV0Pg==" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>{{ if eq .Title .Site.Title }}{{ .Site.Title }}{{ else }}{{ with .Title }}{{ . }} on {{ end }}{{ .Site.Title }}{{ end }}</title>
    <link>{{ .Permalink }}</link>
    <description>Recent content {{ if ne .Title .Site.Title }}{{ with .Title }}in {{ . }} {{ end }}{{ end }}on {{ .Site.Title }}</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>{{ site.Language.LanguageCode }}</language>{{ with $authorEmail }}
    <managingEditor>{{.}}{{ with $authorName }} ({{ . }}){{ end }}</managingEditor>{{ end }}{{ with $authorEmail }}
    <webMaster>{{ . }}{{ with $authorName }} ({{ . }}){{ end }}</webMaster>{{ end }}{{ with .Site.Copyright }}
    <copyright>{{ . }}</copyright>{{ end }}{{ if not .Date.IsZero }}
    <lastBuildDate>{{ .Date.Format "Mon, 02 Jan 2006 15:04:05 -0700" | safeHTML }}</lastBuildDate>{{ end }}
    {{- with .OutputFormats.Get "RSS" }}
    {{ printf "<atom:link href=%q rel=\"self\" type=%q />" .Permalink .MediaType | safeHTML }}
    {{- end }}
    {{- range $pages }}
    <item>
      <title>{{ .Title }}</title>
      <link>{{ .Permalink }}</link>
      <pubDate>{{ .Date.Format "Mon, 02 Jan 2006 15:04:05 -0700" | safeHTML }}</pubDate>
      {{- with $authorEmail }}<author>{{ . }}{{ with $authorName }} ({{ . }}){{ end }}</author>{{ end }}
      <guid>{{ .Permalink }}</guid>
      <description>{{ .Content | transform.XMLEscape | safeHTML }}</description>
    </item>
    {{- end }}
  </channel>
</rss>
